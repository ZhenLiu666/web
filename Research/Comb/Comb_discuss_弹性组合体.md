### 交流学习_弹性组合体问题

> Copyright ZhenLiu



#### 220619  刘震 石钟慈老师课本

- 讲解石钟慈老师的书本讲义

  - 弹簧模型的三种建模求解思路；
    - 平衡方程，建立外力和内力的平衡；
  
    - 能量最小原理，应变能和外力功的总和最小；
  
    - 虚功原理，虚应变能和虚外力功是一样大的；
  
  - 杆的拉伸模型：
    - 一维杆的拉伸满足$\delta l = \frac{Fl}{EA}$
    - 杨氏模量没有单位；
    - 泊松比定义和一般的取值范围；
    - 等截面杆单元上的应力是相等的，位移是线性的；
  





#### 220626  马睿 薄板弯曲豆丁

- 具体内容参见：[薄板弯曲-豆丁网](https://www.docin.com/p-2305587442.html)

  - 薄板区别于厚板。通常情况下, 板的厚度 $t$ 与板面的最 小尺寸 $b$ 的比值满足如下条件:
  $$
    \left(\frac{1}{80} \sim \frac{1}{100}\right)<\frac{t}{b}<\left(\frac{1}{5} \sim \frac{1}{8}\right)
  $$
    则称为薄板。

  - 考虑小挠度薄板（假设薄板的抗弯刚度很大，弯曲变形的程度远小于薄板的厚度），给出如下假设：

    - 垂直于中面的线应变可以忽略不计；

    - 次要应力分量引起的变形忽略不计，即平面应力中的假设；

    - 薄板中面内的各点没有平行于中面的位移；

  - 根据上述假设推导由挠度表示的方程以及边值条件；

  - 给出一些求解薄板弯曲问题的一些解析方法和解析的例子；


- [平面两种模型平面应力和平面应变问题](https://cn.comsol.com/blogs/what-is-the-difference-between-plane-stress-and-plane-strain)：

  - 平面应变问题（平面内xy，平面外z）：

    - 比较真实的三维情况的简化，一般的二维平面问题是三维问题中忽略端部影响之后的简化，对于结构力学来说，平面内发生拉伸时，平面外的方向要发生压缩，但是由于平面应变问题沿着平面外方向的位移是0，因此这种简化可以认为是精确的。

    - 一般用于：z一个维度远大于另外两个维度xy；此时沿x方向的3个应变值为0；可得公式：
      $$
      \begin{aligned}
      \sigma_x & =\frac{E}{1+\nu}\left(\varepsilon_{x x}+\frac{\nu}{1-2 \nu}\left(\varepsilon_{x x}+\varepsilon_{y y}\right)\right) \\
      \sigma_y & =\frac{E}{1+\nu}\left(\varepsilon_{y y}+\frac{\nu}{1-2 \nu}\left(\varepsilon_{x x}+\varepsilon_{y y}\right)\right) \\
      \sigma_z & =\frac{E \nu}{(1+\nu)(1-2 \nu)}\left(\varepsilon_{x x}+\varepsilon_{y y}\right) \\
      \tau_{x y} & =2 G \varepsilon_{x y} \\
      \tau_{y z} & =0 \\
      \tau_{x z} & =0
      \end{aligned}
      $$

    - 生活中常见的模型是：大坝；

  - 平面应力问题（平面内xy，平面外z）：

    - 考虑的情况一般是xy两个维度远大于另外一个维度z；此时沿z方向的3个应力值为0；对于薄结构，横向应力可以忽略不计，因此平面应力是一个很好的假设。对于中间厚度，应力状态是完全三维的。对于长物体，除两端外，横向应力是恒定的。

    - 对于平面应力, 可以使用 $\sigma_z=0$ 来消除 $\varepsilon_{z z}$, 从而得到
      $$
      \begin{aligned}
      \sigma_x & =\frac{E}{1-\nu^2}\left(\varepsilon_{x x}+\nu \varepsilon_{y y}\right) \\
      \sigma_y & =\frac{E}{1-\nu^2}\left(\varepsilon_{y y}+\nu \varepsilon_{x x}\right) \\
      \sigma_z & =0 \\
      \tau_{x y} & =2 G \varepsilon_{x y} \\
      \tau_{y z} & =0 \\
      \tau_{x z} & =0
      \end{aligned}
      $$
      横向应变(即厚度变化)可由解计算为: $\varepsilon_{z z}=-\frac{\nu}{1-\nu}\left(\varepsilon_{x x}+\varepsilon_{y y}\right)_{\text {。 }}$ 。

    - 生活中常见的模型是：圆盘，薄板；

    - 在平面应力公式中，假定与 *z* 方向有关的三个应力张量分量为零。这是薄板的一个很好的近似，但只有在厚度趋近于零的极限时才完全正确。**在自由表面上，平面应力的局部状态总是存在的**，因为这正是边界条件。这就是平面应力假设如此有效的原因——它在板的两侧都是完全正确的，并且只要厚度很小，内部就不会产生显著的 *z* 方向应力。只要在平面内存在应力(和应变)梯度，这种厚度变化就不是均匀的。在应力集中的地方，比如板上的孔，应力最大的地方的材料会希望比周围的材料更薄。相邻的材料会与之相反，并试图抑制变形。平面应力问题沿z方向也是会产生应变的，并且应变和xy方向的应变是有关系的；

  - 澄清两个常见的误解:

    1. 仅仅因为一个物体在横向上是自由的，并不意味着它处于平面应力状态。
    2. 长物体不一定处于平面应变状态。这只有在两端固定的情况下才成立。

    事实是:

    - 具有自由边界的薄物体可以用平面应力来近似。
    - 一远离末端的具有自由边界的长物体，可以通过广义平面应变来近似。
    - 一个与平面内尺寸厚度相当的物体必须被认为是完全三维的。
    - 同一材料达到同一应变所储存的势能, 在平面应变状态大于平面应力状态。这意味着同一材料按平面应变即一向位移约束的模式工作时比按平面应力即一向位移自由的模式时具有更大的抗拉压能力。






#### 220703  张瑞殊 黄建国多结构体

- 文章链接：<a href="pdf/FEM_huang2006_GeneralElasticMultistructures.pdf" target="_blank">多弹性组合体结构（黄建国2006）</a>

- 文章主要介绍多弹性体结构的有限元离散方法，基本思路是：
  
  |      | 未知量  | 离散单元 | 未知量       | 离散单元 | 未知量 | 离散单元  |
  | ---- | ------- | -------- | ------------ | -------- | ------ | --------- |
  | 体   | (u,v,w) | 线性元   |              |          |        |           |
  | 板   | u,v     | 线性元   | w            | Morley元 |        |           |
  | 粱   | u       | 线性元   | $\theta_{x}$ | 二次元   | v,w    | Hermite元 |
  
- 研究多结构体的时候必须规定好如下的记号：

  - 体板粱记号：$\Omega=\left\{\alpha_1, \cdots, \alpha_{N_3} ; \beta_1, \cdots, \beta_{N_2} ; \gamma_1, \cdots, \gamma_{N_1}\right\}$

  - 边界和点的记号：We denote all proper boundary area elements of bodies by where
    $$
    \Gamma^2:=\left\{\beta_{N_2+1}, \cdots, \beta_{N_2^{\prime}}\right\}=\Gamma_1^2 \cup \Gamma_2^2,
    $$
    $$
    \Gamma_1^2:=\left\{\beta_{N_2+1}, \cdots, \beta_{N_2+M_2}\right\}, \quad \Gamma_2^2:=\left\{\beta_{N_2+M_2+1}, \cdots, \beta_{N_2^{\prime}}\right\} .
    $$
    Here $\Gamma_1^2$ consists of all external proper boundary area elements while $\Gamma_2^2$ consists of all interfaces of bodies. boundary points. An element of $\Omega^3, \Omega^2 \cup \Gamma^2, \Omega^1 \cup \Gamma^1$ and $\Gamma^0 \cup \Gamma_3^0$ are called respectively a body, area, line and point element.

  - 局部坐标系：板和点采用全局坐标系，板的局部坐标系是横向为z方向，粱的局部坐标系是纵向为x方向

  - 相互之间关系：$\varepsilon(\beta, \gamma):= \begin{cases}0 & \text { if } \gamma \notin \partial \beta, \\ 1 & \text { if } \gamma \in \partial \beta, \vec{e}_1^\gamma \text { and } \vec{t}^\beta \text { have the same direction on } \gamma, \\ -1 & \text { if } \gamma \in \partial \beta, \vec{e}_1^\gamma \text { and } \vec{t}^\beta \text { have the opposite direction on } \gamma\end{cases}$

- 多弹性体的问题的设定：

  - 所有变量允许的空间应该是：

  - $$
    \vec{v}:=\left\{\left\{\vec{v}^\alpha\right\}_{\left\langle\in \Omega^3\right.},\left\{\vec{v}^\beta\right\}_{\beta \in \Omega^2}^{\rightarrow},\left\{\vec{v}^{\gamma}\right\}_{\gamma \in \Omega^1},\left\{v_4^\gamma\right\}_{\gamma \in \Omega^1}\right\}
    $$
    in $\prod_{\alpha \in \Omega^3} \vec{W}(\alpha) \times \prod_{\beta \in \Omega^2} \vec{W}(\beta) \times \prod_{\gamma \in \Omega^1} \vec{W}(\gamma) \times \prod_{\gamma \in \Omega^1} H^1(\gamma)$

    - 注意上述给定的空间是连续问题考虑的空间，对于粱单元只有扭转自由度是考虑的；对于粱单元的弯曲曲线，可以由前两个自由度对应的曲线求导得到；
    - 注意对于$\vec{W}(\gamma):=H^1(\gamma) \times\left(H^2(\gamma)\right)^2$来说，不同自由度所在的空间是不一样的，对于$\beta$也需要类似的考虑，特别的，强制边界条件应该也加在所考虑的空间上。

  - 如果考虑刚性约束的话，应该加上约束：
    $$
    \begin{gathered}
    \vec{v}^\alpha=\vec{v}^{\alpha^{\prime}} \text { on } \beta, \forall \alpha, \alpha^{\prime} \in \partial^{-1} \beta, \forall \beta \in \Gamma_2^2 ; \\
    \vec{v}^\beta=\vec{v}^{\beta^{\prime}}, \quad \varepsilon(\beta, \gamma) \partial_{\vec{n}^\beta} v_3^\beta=\varepsilon\left(\beta^{\prime}, \gamma\right) \partial_{\vec{n}^{\beta^{\prime}}} v_3^{\beta^{\prime}} \quad \text { on } \gamma, \forall \beta, \beta^{\prime} \in \partial^{-1} \gamma, \forall \gamma \in \Gamma_2^1 ; \\
    v_i^\gamma \vec{e}_i^\gamma=v_i^{\gamma^{\prime}} \vec{e}_i^{\gamma^{\prime}}, \quad v_{i+3}^\gamma \vec{e}_i^\gamma=v_{i+3}^{\gamma^{\prime}} \vec{e}_i^{\gamma^{\prime}} \quad \text { on } \delta, \forall \gamma, \gamma^{\prime} \in \partial^{-1} \delta \cap \Omega^1, \forall \delta \in \Gamma_2^0, \\
    \text { where } v_5^\gamma:=-d v_3^\gamma / d x_1^\gamma, v_6^\gamma:=d v_2^\gamma / d x_1^\gamma ; \\
    \vec{v}^\alpha=\vec{v}^\beta \quad \text { on } \beta, \forall \alpha \in \partial^{-1} \beta, \forall \beta \in \Omega^2 ; \\
    \vec{v}^\beta=\vec{v}^\gamma, \quad-\varepsilon(\beta, \gamma) \partial_{\vec{n}^\beta} v_3^\beta=v_4^\gamma \quad \text { on } \gamma, \forall \beta \in \partial^{-1} \gamma, \forall \gamma \in \Omega^1 .
    \end{gathered}
    $$
    Here,
    $$
    \vec{v}^\alpha:=v_i^\alpha \vec{e}_i^\alpha, \quad \vec{v}^\beta:=v_i^\beta \vec{e}_i^\beta, \quad \vec{v}^\gamma:=v_i^\gamma \vec{e}_i^\gamma
    $$

    - 前三个约束指的是体与体之间，板与板之间，梁与粱之间的连接；
    - 后两个约束指的是体与板之间，板与粱之间的约束；
    - 注意上述关于板和粱之间的约束，指的是粱作为板的某一个边界，即完全重合，这三个位移自由度要求完全一致，扭转自由度要求完全一致；$\vec{v}^\beta=\vec{v}^\gamma, \quad-\varepsilon(\beta, \gamma) \partial_{\vec{n}^\beta} v_3^\beta=v_4^\gamma \quad$ on $\gamma, \forall \beta \in \partial^{-1} \gamma, \forall \gamma \in \Omega^1$

  - 还应该考虑边界条件，给定某个板的某条边界是clamped的：$\vec{u}^{\beta_1}=\overrightarrow{0}, \partial_{\vec{n}^{\beta_1}} u_3^{\beta_1}=0 \quad$ on $\gamma_{N_1+1}$

- 问题适定性：

  - 首先定义离散空间的范数：

    - 离散空间是相应连续空间的离散形式，每个连续空间对应一个未知量，注意区分未知量和自由度，比如对于粱的挠曲线函数是未知量，但是由于采用Hermite元，在每个节点处取两个自由度，分别是挠度和转角，注意这时候离散空间上的两个自由度必然是无关的；
    - 因此对于粱单元，连续空间和离散空间都是4个空间的乘积，对于yz方向的挠曲线的逼近采用Hermite单元，但是离散的时候，选择4个自由度在每个单元上；
    - 定义离散范数的时候，只需要注意对于二阶问题使用1半模，对于四阶问题使用2半模即可；

  - 证明连续形式的Korn不等式

    - 两种形式
      - 高一阶的范数加上边界上的估计
      - 高一阶的范数加上低一阶的0范数

    - 对于上述定义单元分别进行估计

- 解的存在唯一性定理



#### 220807  瑞姝 RM板的四边形元构造（待完善）

- 参考文献：明平兵，石钟慈老师
- RM板单元考虑剪切效应，因此其对应的变分形式和原始变分形式有一定的差别；
- 瑞姝师姐推导了关于RM板变分形式：
- 瑞姝师姐推导了关于RM板变分形式利用Hemletz分解得到的分解问题：
- 对应的有限元实现：
- 马睿师姐提出可以做的两个问题：
  - 一个是将divdiv的胡张元推广应用到RM板模型中实现；
  - 一个是将胡张元应用到弹性组合体的结构中实现；





#### 220814  瑞姝 三角形协调胡张元（待完善）

- 参考文献：A FAMILY OF CONFORMING MIXED FINITE ELEMENTS FOR LINEAR ELASTICITY ON TRIANGULAR GRIDS 胡俊and张商友
- 胡张元的构造：
  - 三角形上的胡张元可以看成是对AW元的简化，AW元是用$H(div)-P_{k+1}$元对应力空间进行逼近，但是实际上有很多div-free的项是不能提供收敛阶，因此胡张元选择$H(div)-P_{k}$加上部分bubble去离散应力空间，$P_{k-1}^{-}$去进行离散位移空间，最后得到的收敛阶是标准的。
  - H(div)-bubble函数指的是沿着三角形的每条边的法向值为0，从而加上此函数不影响协调性。
    - $\mathbb{T}_{E_i}=\mathbf{n}_i^{\perp} \mathbf{n}_i^{\perp T}$每条边内部节点对应的张量基是由每条边上的切向量形成的；
    - $\tau_{E_i, j}=\phi_{E_i, j} \mathbb{T}_{E_i}, \quad j=1,2, \ldots, k-1, i=0,1,2$ 每条边内部k-1个edge-bubble乘以这条边对应的张量可以形成三角形上的一个div-bubble
    - 注意edge-bubble function是指在某个边上不等于0，在边顶点是零；而H(div)-bubble function是说沿着边的法向在这个边上的值是0；H1-bubble function是说在边上的值是0；所以总结一下就是说：**bubble function是满足零边值的函数。**
    - 可以验证$\left.\tau_{E_i, j} \cdot \mathbf{n}_l\right|_{E_l}=0, i, l=0,1,2, j=1, \cdots, k-1$，从而在每个三角形有3(k-1)的div-bublle
  - 由上述bubble函数的构造，可以给出局部胡张元的构造：
    - 顶点和内部点采用标准张量基，并且3个自由度都是连续自由度，即3个全局自由度；
    - 边内部的点采用切向法向的张量基
      - 对于$\mathbb{T}_{E_i}$，采用间断自由度，在公共边相邻的两个三角形上各定义1个自由度，因此在每个三角形内部看是1个自由度，但是全局来看这个节点对应的这个张量基是2个自由度；
      - 对于$\mathbb{T}_{E_i}$的补张量基，采用连续自由度，即2个全局自由度
    - 因此从整体来看，可以看成是$P_{k}$多项式张量基上，再所有的内部边的内部节点处加了一个$H(div)-P_{k}$所构成的有限元离散空间；
- 稳定性的证明不借助Fortin算子，而是证明$V_{h} \in div(\Sigma_{k,b})$并且$div(\Sigma_{k,b}) $ TODO
- 什么叫胡张元？严格说胡老师和张老师单纯形的元是胡张元，其他的不是都是跟张老师合作的，不过很多分析方法都是跟那几篇类似用两步法，这些都可以近似称为是胡张元。





#### 220828  瑞姝 H(divdiv)元的构造（马睿，张敏）

- 四阶问题的变分形式：
- 构造$H(divdiv)$元需要满足的边界条件是：
- 讲解二维三维任意次胡张元的构造思路：
  - 矩形上胡张元的唯一可解性的证明：
    - 首先考虑的是参考单元，矩形的四条边都是平行于坐标轴的，因此限制在一个边的时候，$\xi,\eta$等于常数；
    - 针对主应力和剪切应力采用的是不同的空间进行离散；
    - 注意这个是结论，不是我们需要满足的条件：$\int_{\hat{K}}\left(1-\xi^2\right)\left(\hat{g}_1+b_1 L_{k-1}(\eta)\right) J_{k-1}(\xi) d \xi d \eta=0$，这是由于Jocobi多项式的性质给定的，注意$\hat{g}_1$和$b_{1}$和其积分的值为0；
  - 自由度如何确定？
    - 有限元求解的时候，只要知道形函数，和对应的自由度取法，就可以计算出最后的系数值，并不非要给定节点自由度；
    - 矩形的边上给定的是确定$P_{k-1}$的自由度；
    - 最后一个条件是内部确定一个$P_{k-2}$的自由度，韩豪师兄的想法是在内部给定一个Lagrange三角形确定出来；
  - 对应的基函数形式是什么？
    - 通用计算方法：先计算内部的基函数，然后再计算外部的基函数，减去内部的基函数即可；
    - 需要注意一点：给定的形函数可以写成一些节点的值乘以对应的Lagrange基函数，当然也可以利用Nweton插值的写法写成别的多项式形式，这里最终作为求解变量的是每个基函数前面的系数，对应的不一定是节点值，不一定具有几何意义，类似的，有时候求解的时候我们需要将求解出来的“系数”进行适当的转化变成节点基函数；





#### 220904  刘震 板问题的几何意义

- 四阶问题的求解未知函数就是挠度；
- 关于四阶问题的边值条件的提法：
  - 固支板情况，给定的是位移和转角都是0的情况，对应为$u=u_{n}=0$；
- 思考为什么挠度关于边界的法向导数表示的是转角？实际上是由几何意义给定的。





#### 220918  瑞姝 位移法求解两个板拼接模型

- 背景介绍：
  - 薄板弯曲模型采用Kichoff假设，平面应力问题采用平面应力模型；
  - 薄板弯曲和平面应力模型采用的假设都是$\sigma_{13}=\sigma_{23}=\sigma_{33}=0$，忽略$\varepsilon_{33}$带来的影响；
  - 不同之处在于对于平面应力模型的变形在平面内的，直接由三维的模型可简化成二维，没有中面法假设；
  - 薄板弯曲模型由于变形主要是挠度，因此将平面的位移用挠度表示，根据中面假设，得到关于挠度的四阶方程；
  - 作用于面元 $S$ 上的横向面积载荷, 量纲 为力/面积$P_3 \approx g_3^{+}+g_3^{-}+\int_{-h / 2}^{h / 2} f_3 d x_3$，注意在考虑薄板弯曲问题的时候，需要关于整个薄板单元进行积分，此时会出现板的厚度，对应平衡方程中的体力实际应该理解为上述形式；
- 受力情况介绍：
  - 平面应力问题：受到纵向的体力，和边界上沿着纵向的力；
  - 薄板弯曲问题：受到横向的体力和表面力，和边界上沿着横向的力；
- 薄板弯曲问题的材料力学理解方式：
  - 关于$u_{1},u_{2}$表达式，通过中性面的挠度和相关的转角，由于剪切应变对应的是角度，从而可以推出其他点的位移；
  - 关于边界上沿着切向的转角$\omega_{t} = \omega_{1}\cdot t_{1} + \omega_{2}\cdot t_{2} = -\frac{\partial \omega}{\partial n}$，即关于切向的转角可以看成是平面上的转角沿着切向的分力，需要注意的是这里的$\omega_{t}$并不是挠度关于切向的导数，反而是关于法向的导数；
    - 弯矩的理解方式，弯矩是向量，可以沿着切向和法向进行分解，$\mathcal{M}=\mathcal{M}_t \boldsymbol{t} + \mathcal{M}_n \boldsymbol{n}$，其中沿着$t$方向的分量指的是弯矩螺旋之后的方向，大小就是弯矩的大小。
    - 功除了可以看成力乘以位移之外，还可以看成弯矩乘以对应的转角，比如$\mathcal{M}_t \cdot \omega_{t}$可以得到对应切向的功；
- 薄板弯曲
  - 根据冯康老师的教材推导薄板弯曲的方程，从变分形式推导平衡方程；
  - 之前马睿师姐讲解的豆丁网，是从平衡方程进行推导的；



#### 220926  瑞姝 位移法求解两个板拼接模型2

- 刘震讲解薄板弯曲问题对应的位移的三种理解方式：
  - 公式法，只要知道应变和旋转张量的值，可以由冯康老师的书中公式计算得到位移；
  - 应变角度，假设法+积分公式，根据应变为0，沿着某个方向进行积分可以得到对应的位移；
  - 旋转角度，只要知道转角的值，就可以用$\omega_{ij}$和$(x,y,z)$坐标进行叉乘，得到对应的位移变形；
- 刘震讲解



#### 221010 刘震 位移法求解两个板拼接模型

讲解两个板拼接的计算模型



#### 221017  刘震 位移法求解两个板拼接模型2

- 讲解两个板拼接的计算模型；
- 弹簧连接条件下的强制位移和虚位移的概念；



#### 221024 张瑞姝

- 讲解板问题对应的弹性力学模型；



#### 221031 马睿 

- 讲解四阶问题的混合形式边值问题；



#### 221107 瑞姝 板问题混合形式1

- 推导薄板弯曲问题的混合变分形式：
  - 首先是变量的区别，对应于

- 刘震提出：如果将位移看成是强制边值的话，如何刻画$L^{2}$函数在边界上的值和其对应的法向导数？
  - 由于$L^{2}$函数的迹是属于$H^{-\frac{1}{2}}$的，因此无法作为强制边值，不知道该如何去计算？
  - 实际上在四阶问题的混合形式中位移是作为自然边值出现在变分形式中的，但是由于值为0，因此对应的项没有出现；
  - 因此研究重点是如何解决简支边值和自然边值提法对应问题的混合元求解？

- 非齐次边值问题下混合形式的推导：
  - ![image-20230215230441715](/Users/liuzhen/Library/Application Support/typora-user-images/image-20230215230441715.png)

- 计算问题：
  - 可以计算1/4板的混合问题的形式；
  - 涉及到力和固支的约束；






#### 221114 刘震 薄板弯曲问题的变分形式推导

- 考虑实现工程文章中的算法（见pdf文件工程实践）；

- 讲解三种混合元变分原理求解薄板弯曲问题的等价性；

  - 基于位移求解的虚
  - 基于变形
  - 混合变分原理；

- 基于加权Sobolev空间实现的薄板弯曲问题的误差估计：
  $$
  \|u\|_{4, \sigma, \Omega} \leqq C\left\{\|f\|_{0, \Omega}+\left\|u_0\right\|_{4, \Omega}+\|u\|_{2, \Omega}\right\}
  $$

- 讲解混合元的实现细节：

  - 对于分片常数的单元，只需取每个边中点处沿着法向的位移作为自由度即可；
  - 对于分片线形的单元，每个单元上有9个自由度，考虑到沿着法向连续，因此每个顶点处需要贡献两个自由度作为整体的自由度，剩下的三个自由度作为内部自由度即可；





#### 221121 张瑞姝 板问题混合形式2

- 给出板问题三种混合边值下的变分问题的提法：
- 给出板问题的局部单元选取方式（主要参考chenlong老师元的提法）：
- 马睿师姐讲解$H(divdiv)$离散元的证明思路：
  - 实际上还是采用的胡张元的证明思路，分成两个步骤完成；
  - 胡张元的证明：
    - Step1:证明$div(bubble) = RM$的补空间；
    - Step2:证明边界自由度可以确定出RM空间；

  - $H(divdiv)$元的证明：
    - Step1:证明$divdiv(bubble) = P_{1}$的补空间；
    - Step2:证明边界自由度可以确定出$P_{1}$空间；

  - 关于板问题的证明难点主要是在第二点，边值条件更复杂，如何确定出$P_{1}$空间，但是总体来看应该没问题，因为大部分已经被bubble函数给定了，边界条件只占比较少的部分。

- TODO：跳跃项是否需要加到自由度上去，根据数值试验结果看产生的影响是什么？ 





#### 221128 瑞姝 两个板拼接问题混合形式1

- 考虑问题：

  - 两个板拼接模型的混合元求解方法；
  - 给定$S$的一部分边值是固支的$\partial S_{0}$；
  - 其余边值全部都是自由的；
  - 但是需要考虑两个板交接处$\Gamma$如何处理？

- 中间胡老师打电话关心疫情发展😷

- 马睿师姐关于两个板交界面上的边值条件的提法：

  - 假设考虑的是位移元，之前的位移法中给出了刚性连接和弹性连接所对应的条件；
  - 假设考虑的是混合元，应该考虑是否把力的平衡也加上去：
    - 可以参考huang老师文章中位移约束得到的关系式，帮助我们给出力的条件应该怎么提？
    - 要想将混合问题在交界面上的关系式整合，可能需要提出$Mnn$是连续的？

- 瑞姝师姐推导出单个板的混合形式：

  - 基本思路是：

    **平衡方程+边值条件+交界面条件 -----(测试函数+分部积分)-->    变量所应在的空间 + 双线性形式的提法；**

  - 注意在推导混合形式是要满足混合形式格式的要求，即a(u,v)+b(p,q)=0 b(p,q)=0这种形式；

  - 注意在混合形式中关于变量的导数是否有意义？假设考虑$L^{2}$空间，那么所有的导数都要通过分部积分进行转移；

  - 混合形式中的未知项可以出现在方程的左边进行求解，比如$(\omega，Div \cdot n + \frac{\partial N_{nt}}{\partial t})$，但是这样计算起来可能会非常复杂，因此可以对测试函数施加某些条件使得问题变得简单；

  - 混合形式中的未知项也有可能是无法计算的或者是与空间正则性不匹配的，比如$(\frac{\partial \omega}{\partial n}，Nnn)_{\partial S_{1}}$，这个时候要对测试函数施加某些条件使得问题可以进行求解；

- 问题的适定性：

  - 现在的考虑的空间是两个板拼接之后整体上的定义的空间，因此要先考虑在这个空间上的连续问题对应的inf-sup条件是否成立；
  - 之后与chenlong老师文章中的思路可以一致，利用算子的交换性给出离散问题的适定性（参考）；
  - 假设离散的空间是连续空间的一部分，就可以构造插值算子，问题是离散空间的构造是否满足这个性质？主要是交界面上的条件是否能保持下来。





#### 221205 瑞姝 两个板拼接问题混合形式2

- 瑞姝师姐讲解纯弯曲模型的PDF文件：
  - 考虑两个板拼接的混合变分形式的提法（给出了检验函数和试探函数空间的取法）；
  - 给出混合形式的表达式，并且给出需要证明的infusup条件具体的形式？
- 马睿师姐分析两个板只有纯弯曲的模型是否是合适的？
  - 马睿师姐认为只有当两个板平行的时候才是合适的，原因是我们考虑的约束是两个板的挠度相同是不合理的吗？
    - 假设不考虑平面应力问题，那么当两个板平行的时候对应的问题和一个板对应的问题是一样的；
    - 假设考虑平面应力问题，这时候两个板拼接的话平面应力和薄板弯曲会产生耦合的效应；
    - 如果只考虑纯弯曲变形，那么瑞姝师姐写的只适应于两个板平行的时候的模型，且当考虑弹性连接才有意义；
  - 讨论班上胡老师指出板问题什么时候可以分解成平面应力模型和薄板弯曲模型考虑？
- 记号的约定：
  - 当两个板不平行的话才是需要考虑的问题，此时需要建立两个局部坐标系和全局坐标系，以及如何进行转化；
  - 因此两个板上的$Div$算子实际上是不一致的，可以预先定义好不同的符号，在不同的板上采用不同的算子；
- ⚠️当考虑平面应力模型的时候，关于两个板交界面上的条件如何给定？
  - 参考huang2005文章（3.30）式子；
  - 还有文章里面涉及到的其他式子作为参考；
- 讨论一些零碎的问题：
  - 关于低次非协调元的估计的离散单元构造的理解（参考马睿师姐提供的笔记）；
  - 自由度是整体的还是局部的，取决于离散的infsup条件是否成立，如果是整体的相当于要求的连续性比较强，但是局部的话相当于在这里人为的引入一个间断，比如胡张元的bubble函数；
  - 对于四边形单元一般是需要有完整的Qk次多项式，通过仿射变换拉到一般单元进行估计的时候，在进行插值估计的时候，会有变换对应的Jocobi，所以实际上关心的是一般单元上的完全多项式的次数；
  - ❓ 用U，L等来判断不等式的估计尺度，边的时候是$L^{1/2}$，内部的时候就是$L$，如果是函数本身就是U，但是求导的时候会出来$1/L$之类的项然后进行估计？





#### 221212 刘震 张瑞姝

- 刘震讲解弹性薄板自由边界条件的理解：$Q_{3 n}(w)+\frac{\partial M_{t n}(w)}{\partial l}=q_3$

  - 首先关注平衡方程：$-\sum_{i=1}^2 \frac{\partial Q_{3 i}(w)}{\partial x_i}=P_3$，这里需要注意两个事情：

    - 在区域内部分析的时候，总是可以取一个正方体微元分析，限制在平面问题上的时候，总是有沿着$x_{1},x_{2}$两个方向的平面；

    - 在内部区域取一个圆柱体，圆柱体的侧面上的横向剪力$\oint_{\partial S} \sum_{i=1}^2 {Q}_{3 i} n_i d l$，而作用在整个体内部的力可以看成是：$P_3 \approx g_3^{+}+g_3^{-}+\int_{-k / 2}^{k / 2} f_3 d x_3$，即上下表面上的面力和体内部沿着横向的积分的合力，利用散度公式可以得到平衡方程；

    - 进一步分析平衡方程中的剪力项，由绕 $x_1, x_2$ 轴向的力矩平衡得到横向剪力 $Q_{3 i}$ 与弯矩 $M_{i j}$ 的关系式：${Q}_{3 i}=\sum_{j=1}^2 \frac{\partial M_{i j}}{\partial x_j}$

      也就是说${Q}_{31}=\frac{\partial M_{11}}{\partial x_1} + \frac{\partial M_{12}}{\partial x_2}$，$Q_{31}$是作用在沿$x_{1}$平面上的沿横向的剪力，$M_{11}$会产生作用在沿$x_{1}$平面上的绕$x_{2}$轴的弯矩，而$M_{12}$会产生作用在$x_{2}$平面上的绕$x_{2}$轴的扭矩；这里需要注意的是当考虑的力作用在沿哪个方向的平面时，就认为这个方向是轴向来看待这个力是扭矩还是弯矩，弯矩的法向和轴向是垂直的，但是扭矩的法向和轴向是平行的；

  - 对于边界上的剪力平衡，应该把上述的沿着$x_{1},x_{2}$两个方向的平面改成沿着$n,t$两个方向的平面，将内部的剪力求散度变到边界上就不需要求散度了，然后有一些简化就得了上述的公式。

- 讨论解决上次胡老师提出的什么时候可以将板的问题看成是平面问题和薄板弯曲问题的叠加？

  - (i) a distribution of forces whose resultant is $p=p_i e_i$ on the middle surface $S$ and whose resultant moment is 0 on $S$
  - 上述摘自两个板拼接问题中关于外力施加的描述，翻译成施加的力给出的合力为$p$，合力矩为$S=0$，并不是施加的力$p$造成的合力矩$S=0$。那么$p$造成的力矩影响是什么呢？实际上冯老师书中已经给出了答案，根据沿$x_{1},x_{2}$两个方向的力矩平衡，才可以得到$M$和$Q$的关系，从而得到平衡方程，因此力矩平衡已经蕴含在平衡方程中了；
  - 回到问题本身，实际上只要是考虑单个板的情况，总是可以看成平面问题和薄板弯曲问题的叠加：
    - 平面应力问题是指中面发生位移，但是没有产生横向位移；
    - 薄板弯曲问题是指$z=x_{3}$方向的所有点的位移相同，虽然会产生$x_{1},x_{2}$方向的位移，但是对于中面来说位移是0；
    - 从两者联立的方程来看，并没有耦合的项，从而两个问题是可以分离的；
    - 但是当我们考虑两个板拼接问题的时候，就可能会产生耦合作用的项；

- 关于自由边界项中包含跳跃项的讨论：

  - 下述描述摘自冯老师书：当边界 $\partial Q$ 的角点 $P_i$ 不受载荷时, 扭矩 $M_{t n}$ 在该点为连续. 如在 $P_i$ 有点载荷 $r_i$, 则在外功势能 $-F(v)$ 中应增加“点项” $-r_i v\left(P_i\right)$, 这时可导出 $P_i$ 点的平衡方程 ${P_i:}\left[M_{t n}(w)\right]_{p_i^{-}}^{p_i^{+}}=r_i$，它表示扭矩在 $P_i$ 必有跳跃, 以产生有效的撗向点力而与点载荷 $r_i$ 平衡.
  - 从上述描述可以看出对于自由边界，在两个直线段相交的点处，施加的点载荷为0的特殊情况造成的边界条件就是跳跃为0，因此必须在方程中加上此条件；当没有受到点载荷，并且扭矩本身是连续的时候，跳跃项确实不需要加到方程中去；
  - 在两个板的文章中，关于一个板给出的方程





由于监考+疫情生病，顺延一周🥹



#### **221226 刘震 HHJ变分原理1**

- 变分方程可以看成是对微分方程进行变分的结果，结合给定的边值条件给出变分函数所在空间的取法；由于变分方程（当算子是自伴随的时候），可以看成是泛函的平衡方程，因此也可以从能量原理的角度推导变分方程。对于二阶问题而言，原始的自然变分原理可以表述成如下的三种等价形式：

  - 微分方程：$\Delta^2 w=f \quad$ in $\Omega, \quad w=\frac{\partial w}{\partial n}=0 \quad$ on $\Gamma$

  - 变分方程：给定 $f \in$ $H^{-1}(\Omega)$, 找 $w \in H_0^2(\Omega)$ 使得：
    $$
    \int_{\Omega} \nabla^2 w: \nabla^2 v d x=\langle f, v\rangle \quad \text { for all } v \in H_0^2(\Omega)
    $$

  - 能量极小：$J(w)=\min _{v \in H_0^2(\Omega)} J(v)$，其中$J(v)=\frac{1}{2} \int_{\Omega} \nabla^2 v: \nabla^2 v d x-\langle f, v\rangle$.

- 混合变分原理，一种是方程本身就需要考虑多个变量，比如stokes方程，一种是为了计算精度等原因引入格外的变量，这时候就需要加上约束，此时也不再是能量极小化问题，而是鞍点问题，具体可以表述如下：

  - 微分方程：引入中间变量$\boldsymbol{w}=\nabla^2 w$，原始微分方程改写成：$\nabla^2 w=\boldsymbol{w}, \quad \operatorname{div} \operatorname{div} \boldsymbol{w}=f \quad$ in $\Omega$
  
  - 鞍点问题：
    - 利用引入的约束，就可以将原始的最小值问题变成鞍点问题。对应的不再是极小化问题，而是鞍点问题的平衡方程，如果想使得鞍点问题是适定的，就要重新研究定义对应乘子的空间。
    
    - 新的变量所属于的空间：$\boldsymbol{L}^2(\Omega)_{\mathrm{sym}}=\left\{\boldsymbol{v}: \boldsymbol{v}_{j i}=\boldsymbol{v}_{i j} \in L^2(\Omega), i, j=1,2\right\}$
    
    - 原始的能量极小问题变成鞍点问题：$\mathscr{L}((v, \boldsymbol{v}), \boldsymbol{\tau})=J(v, \boldsymbol{v})+c((v, \boldsymbol{v}), \boldsymbol{\tau})$
    
    - 其中$J(v, \boldsymbol{v})=\frac{1}{2} \int_{\Omega} \boldsymbol{v}: \boldsymbol{v} d x-\langle f, v\rangle$是使用新的变量改写而成的。
    
    - 其中$c((v, \boldsymbol{v}), \boldsymbol{\tau})=-\int_{\Omega} \boldsymbol{v}: \boldsymbol{\tau} d x-\int_{\Omega} \nabla v \cdot \operatorname{div} \boldsymbol{\tau} d x$是对应约束的表达式，实际上这个约束反映的是$(\boldsymbol{v}-\nabla^2 v):\tau=0$，利用分部积分和原问题的$v\in H^{2}_{0}$，即其在边界上的外法向导数值是0，从而可以给出约束形式的弱形式，上式只需要对$v\in H^{1}_{0}$即可定义。
    
    - ⚠️这里的思路和二阶椭圆问题是类似的，原问题是要求真解是属于$v\in H^{2}_{0}$，这是强解。但是我们利用变分形式的时候，如果是自然边值直接在变分里成立，因此最后对函数本身的要求，只需要满足强制边值即可$v\in H^{1}_{0}$，这样的好处是解更弱了，并且还可以证明这和原问题是等价的。
    
    - 可以计算得到对应的鞍点问题是（关于三个变量求导可以得到三个方程，但是可以将前两个方程合并得到新的方程，最后可以看成如下的方程组）：
      $$
      \begin{array}{rlrl}
      \int_{\Omega} \boldsymbol{w}: \boldsymbol{v} d x+c((v, \boldsymbol{v}), \boldsymbol{\sigma}) & =\langle f, v\rangle & & \text { for all }(v, \boldsymbol{v}) \in H_0^1(\Omega) \times \boldsymbol{L}^2(\Omega)_{\mathrm{sym}} \\
      c((w, \boldsymbol{w}), \boldsymbol{\tau}) &=0    & \text { for all } \boldsymbol{\tau} \in \boldsymbol{M}
      \end{array}
      $$
    
    - 关于待定空间中范数的确定有范数不等式：$\sup _{0 \neq(v, \boldsymbol{v}) \in \boldsymbol{X}} \frac{c((v, \boldsymbol{v}), \boldsymbol{\tau})}{\|(v, \boldsymbol{v})\|_{\boldsymbol{X}}}=\left(\|\boldsymbol{\tau}\|_0^2+\|\operatorname{div} \operatorname{div} \boldsymbol{\tau}\|_{-1}^2\right)^{1 / 2}$，其中$\|(v, \boldsymbol{v})\|_{\boldsymbol{X}}=\left(|v|_1^2+\|\boldsymbol{v}\|_0^2\right)^{1 / 2}$，注意这里有个技巧，就是对于乘积空间中范数的定义，往往是每个Hilbert空间中范数的一个“平均”。可以将变分的定义改写成$c((v, \boldsymbol{v}), \boldsymbol{\tau})=-\int_{\Omega} \boldsymbol{v}: \boldsymbol{\tau} d x+\langle\operatorname{div} \operatorname{div} \boldsymbol{\tau}, v\rangle$，此时第一项就是$\boldsymbol{\tau}$的L2范数，而第二项就是$\|\operatorname{div} \operatorname{div} \boldsymbol{\tau}\|_{-1}$的定义。
    
  - 混合问题：
    
    - 通过在鞍点问题的平衡方程可以得到等量关系式，因此可以将3个变量消去其中一个变成2个变量的方程组，消去不同的变量就可以得到不同的变分问题。由于在考虑乘子空间的时候，已经证明了鞍点问题的适定性成立，因此在消去变量时，只需要采用小空间就可以保持适定性。
    
    - 从而原始问题就可以变成如下的问题：
    
       For $f \in H^{-1}(\Omega)$, find $\boldsymbol{\sigma} \in \boldsymbol{H}^{-1}(\operatorname{div} \operatorname{div}, \Omega)_{\text {sym }}$ and $w \in$ $H_0^1(\Omega)$ such that：
      $$
      \begin{aligned}
      & \int_{\Omega} \boldsymbol{\sigma}: \boldsymbol{\tau} d x \quad-\langle\operatorname{div} \operatorname{div} \boldsymbol{\tau}, w\rangle=0 \quad \text { for all } \boldsymbol{\tau} \in \boldsymbol{H}^{-1}(\operatorname{div} \operatorname{div}, \Omega)_{\mathrm{sym}} \\
      & -\langle\operatorname{div} \operatorname{div} \boldsymbol{\sigma}, v\rangle \quad=-\langle f, v\rangle \quad \text { for all } v \in H_0^1(\Omega) \\
      &
      \end{aligned}
      $$
    
    - 可以证明上述变分形式是适定的，并且和原问题是等价的，等价性的证明：先证明两个方程的解都是唯一的，这时候只需要说明其中一个方程的解是另一个方程的解即可，也就是说只需要完成之前一半的证明即可完成整个等价的解。





#### **230102 刘震 HHJ变分原理2**

- 关于非协调元变分形式的理解：
  - 连续形式：$\langle\operatorname{div} \operatorname{div} \boldsymbol{\tau}, v\rangle=\int_{\Omega} \boldsymbol{\tau}: \nabla^2 v d x-\left\langle\boldsymbol{\tau}_{n n}, \frac{\partial v}{\partial n}\right\rangle_{\Gamma}$
  - 离散形式：$\left\langle\operatorname{div} \boldsymbol{d i v}_h \boldsymbol{\tau}, v\right\rangle=\sum_T\left\{\int_T \boldsymbol{\tau}: \nabla^2 v d x-\int_{\partial T} \boldsymbol{\tau}_{n n} \frac{\partial v}{\partial n} d s\right\} \quad$ for $\boldsymbol{\tau} \in \boldsymbol{V}_h, v \in Q_h$
  - 对于充分光滑的函数，上述两者的形式是统一的，但是对于非协调元，上述两种变分形式是不一样的，第二个是在每个单元上计算的，当$v$不在$H^{1}$空间的时候，对应的$\frac{\partial v}{\partial n}$跨过边界是非连续的，因此往往需要考虑相容性误差；
- 关于离散问题的误差估计：
  - 传统有限元+协调元，只需要证明连续问题的Lax-Milgram定理即可，由于空间是协调的，因此离散问题也是适定的，从而利用Galerkin正交性结合Cea引理可以得到误差估计；
  - 混合有限元+协调元，一般需要证明连续问题和离散问题的inf-sup条件，从而得到对应的正交性条件，再利用离散问题的适定性得到关于插值误差的估计；
  - 对于非协调元，除了分析离散问题的适定性，还需要注意离散形式和连续变分形式之间的相容性误差；



#### **230109 **瑞姝 两个板拼接混合形式3

- 推导两个板拼接时既考虑平面应力，又考虑薄板弯曲的时候对应的变分形式；
- ⚠️交界面条件会产生耦合：
  - ![image-20230216214624993](/Users/liuzhen/Library/Application Support/typora-user-images/image-20230216214624993.png)
  - 上述第三个条件比较好满足，因为对应的是标量，并且在自由度选取的时候可以直接作为整体自由度给出；
  - 上述前两个条件会产生耦合，原因是上述相等指的是在全局坐标下的相等，要对上述向量进行分量的求解，对应的分量相等，因此会产生耦合的效果，这是比较难处理的部分；
  - 由于耦合作用，因此在用有限元空间进行离散的时候要保证交界处匹配，可以尝试采用k和k-1次函数空间去离散平面应力和平面位移，用k+1和k-1次函数空间去离散弯曲的弯矩和挠度对应的空间；
- 边值条件：
  - 位移法求解的时候，位移和转角是强制边值，其他的条件是自由边值；
  - 混合法求解的时候，位移和转角是自然边值，其他的条件是强制边值；
  - 注意考虑的空间是两个板拼接之后对应的空间，要将交界处的条件作为限制加在空间要求上；
- 关于连续情形的适定性的证明：
  - 在ker的函数空间下，正定性的证明是简单的；
  - 但是对于infsup条件，由于现在考虑的问题有耦合，所以虽然胡老师和陈龙老师的元都可以简单的给出适定性的结果，但是不能保证耦合问题的适定性；
  - 根据复形的结论：H(div)和H(divdiv)空间都可以把L2空间映满；但是当我们考虑的是两个板拼接时，不是一个平面，而是三维空间上的两个板，定义在这个上边的H(divdiv)空间是否可以把它映满？
  - 但是特殊情况下，当考虑的两个板是平行的时候，可以采用同一个坐标系，此时就是对应的分量是相等的，因此可以利用上述证明结果叠加即可；
- 关于离散情形的适定性的证明：
  - 只要连续问题是对的，可以构造插值算子保证交界面条件，推出离散问题是适定的；
  - 胡张元三角形的文章中关于插值算子的构造可以参考，但是这个并不是最简单的，可以参考胡老师自己写的任意维上的证明；
- 马睿师姐提出用HHJ解法：
  - 利用HHJ元求解薄板问题，采用P0-P1元，用Lagrange元求解平面应力问题，用P1元，看计算起来是否简单？
    - 交界面上的 耦合条件 和  转角条件  作为自然边值条件；
    - 交界面上的 位移条件 和  弯矩条件  作为本质边值条件；
  - HHJ元比较好的是可以适用曲边的情况，这样之后求解壳问题也是可以的？





中间过年休息了两周～ 😌



#### **230130 全体 讨论新年计划**

- 写文章的两个侧重点研究内容：

  - 理论部分：测试胡张元和陈龙老师的元，完全的协调元；
    - 难点1: 两个板拼接连续问题对应的适定性没有被证明过？涉及到非光滑区域上的$H(div) \rightarrow L^{2}$空间的满射证明以及$H(divdiv) \rightarrow L^{2}$空间满射的证明（其实就是infsup条件）？
    - 难点2: 拼接处的边值条件的提法是否合理？和经典位移法的提法是有区别的，需要重新考虑；
    - 难点3: 对应的数值算例还未实现，实现较为困难；
  - 数值部分：侧重实现HHJ元，完善HHJ元求解两个板拼接问题的代码；
    - 难点1: 两个板拼接的HHJ元代码实现未完成，但是对于$P1-P0$元来说代码实现似乎是简单的；
    - 难点2: 可以利用前人关于HHJ元误差分析的过程，直接跳过infsup的证明；
    - ⚠️HHJ元本质上是非协调单元，但是与huang提出的用Morley元离散薄板弯曲以及用线性元离散平面应力问题不同，HHJ元能保证在两个板拼接处保持位移三个自由度完全相等，从而完全符合提出的边值条件，但是huang的方法只能保持位移的两个自由度和边中点的值相等；

- 关于函数迹的理解：

  - 迹可以看成是函数分部积分出来的所有边界项；

  - 关于$divdiv$函数的迹，陈龙老师文章给出如下公式（因此法向法向只是部分迹）：

    $\begin{aligned}(\operatorname{div} \operatorname{div} \boldsymbol{\tau}, v)_K= & \left(\boldsymbol{\tau}, \nabla^2 v\right)_K-\sum_{e \in \mathcal{E}(K)} \sum_{\delta \in \partial e} \operatorname{sign}_{e, \delta}\left(\boldsymbol{t}^{\top} \boldsymbol{\tau} \boldsymbol{n}\right)(\delta) v(\delta) \\ & -\sum_{e \in \mathcal{E}(K)}\left[\left(\boldsymbol{n}^{\boldsymbol{\top}} \boldsymbol{\tau} \boldsymbol{n}, \partial_n v\right)_e-\left(\partial_t\left(\boldsymbol{t}^{\top} \boldsymbol{\tau} \boldsymbol{n}\right)+\boldsymbol{n}^{\boldsymbol{\top}} \boldsymbol{d i v} \boldsymbol{\tau}, v\right)_e\right]\end{aligned}$

  - 上述公式不能选定零边值的$v$，因为这样就没法出现所有的边值项；

- 关于$\left(\boldsymbol{n}^{\top} \boldsymbol{\tau} \boldsymbol{n}, q\right)_e \quad \forall q \in \mathbb{P}_{k-2}(e), e \in \mathcal{E}(K)$计算方法：

  - 假设考虑$\boldsymbol{\tau}$是$P0$多项式，这时候有三个自由度，在每个边上只有一个自由度，因此在边上就只有一个待定的未知量，直接取值就可以；
  - 但是当$\boldsymbol{\tau}$是高次多项式的时候，此时可以直接计算矩，也就是和低次多项式的基函数的积分值；也可以选择边内部的Gauss节点值作为计算节点；



#### 230206 全体 讨论代码编写ifem

- 瑞殊师姐：
  - 冯康老师课本 模仿组合问题的唯一性证明，利用坐标变换，考虑全局坐标系下的RM空间；
  - 双混合形式的证明包括正定性和infsup条件，正定性因为是$L^{2}$函数内积，在每个板上都具有正定性的话就可以得到整体的正定性，但是infsup条件要求$div$函数是满足的，除了每个板上满足之外，还需要考虑两个板拼接位置处该如何进行处理？
- 刘震：
  - 陈龙老师 双调和问题的代码是混合元实现 可模仿其实现框架，修改其中关于应力的计算；
  - 陈龙老师 线弹性问题的代码不具备处理Neumann边值条件的部分，只能处理纯Dirichlet边值；
- 马睿师姐：
  - 壳单元，矩形单元，每个节点有6个自由度，在ansys中的实现；
  - 板单元，三角形单元，每个节点有3个自由度，包含$\theta_{x},\theta_{y},U_{z}$，如果包含完全的三次多项式需要再引入一个额外的自由度：
    - renxy提供单元，需要在板的中间加一个挠度的自由度；
    - 有限单元法，根据形函数的特征给出一种提法，类似Hermite单元，这种方法只对特定网格收敛；
- 制定新的研究计划：
  - 瑞殊师姐负责整理双混合形式求解的文档，调研推导对应连续和离散问题的存在唯一性；
  - 马睿师姐负责整理Lagrange元和HHJ元求解的文档，证明对应变分问题的存在唯一性；
  - 刘震负责编写Lagrange元和HHJ元的代码，之后实现双混合形式代码；



#### 230214  瑞姝 两个板混合形式适定性1

- 关于交界面上的边值条件的提法：
  - 文章1研究了两个板垂直的交界面的条件，需要把关于交界面上位移的约束加到能量相等上进行推导；
  - 文章2研究了一搬情况下的交界面条件，里面会含有$cos(\theta),sin(\theta)$的一些项；

- 关于infsup条件的证明：
  - 位移法证明思路，在含有固定边界的板上证明正定性，然后借助交界面的条件，证明另一个板上的强制性成立；
  - infsup条件能否借助这个思路完成证明？先在一个板上证明，然后再证明整体的情况？

- 关于两个板拼接交界面条件提法中关于跳跃项应该怎么提？
  - 为什么会出来一个$M_{12}(P_{1})=0$的结论？其中$P_{1}$是交界面上的一个点；
  - 另外关于第二个板上的角点跳跃项应该满足的要求是什么？
  - 假设考虑的不是直角板比如正方形板，而是梯形板比如，那对应的结论应该是什么？

- 马睿师姐讲解交界面上的节点处应该满足的三个条件：
  - 在交界面上的端点处应该施加三个约束：$Mnn$连续，$Mnt,Mnt$分别在两个板的角点连续；
  - 在交界面上的内部节点处应该施加一个约束：$Mnn$连续；
  - 总共在交界面上的节点处应该有6个自由度；

- 马睿师姐讲解$divdiv$算子在边界上的迹的含义：
  - 假设给定的$v \in H(divdiv) $，那么它的迹可以通过公式： $(Tr(v),z) := (div(v),z) + (v,\nabla z)$ 来得到，也就是说$Tr(v)$可以看成是$H^{1}$空间上的一个泛函，计算可以得到$Tr(v) = v\cdot n$
  - 类似的，Traces of $H$ (div div, $\Omega)$. We start by introducing linear operators $\operatorname{tr}_T^{\text {dDiv : }}$ $H(\operatorname{div} \operatorname{div}, T) \rightarrow H^2(T)^{\prime}$ for $T \in \mathcal{T}$ by
    $(3.1) \quad\left\langle\operatorname{tr}_T^{\mathrm{dDiv}}(\Theta), z\right\rangle_{\partial T}:=(\operatorname{div} \operatorname{div} \Theta, z)_T-(\Theta, \varepsilon \nabla z)_T$；
  - 根据两类两类条件中
  - 如果跳跃项算是单独一类的话，分析出来的迹应该有三类？三类条件应该同时满足❓




#### 230221  刘震 单板角点条件

- 关于四阶问题方程的两种中间变量的提法，分别对应四阶混合问题和薄板弯曲问题。

- 关于$[M_{nn}]$的计算：

  - 由于要在H(divdiv)空间，所以在边界上的法向法向的Trace应该是连续的；
  - $[M_{nn}]$跨过三角形的边界是连续的；离散角度：因为节点处的M是相同的，即连续的，因此只需要在边的内部是成立的就可以；
  - 在选择自由度的时候，可以取顶点处，也可以不取顶点处的值作为其中一个自由度；是否选择顶点的值会影响离散空间的大小，但是在这种情况下不影响我们infsup条件的证明；
  - 陈龙老师证明infsup条件，两步法：
    - 用内部自由度处理刚性位移RM的垂直补空间；
    - 用边内部的泡函数处理刚性位移；

- 关于自由边界上拐点处$[M_{nt}]$项的处理：

  - 假设边界上的两条边是垂直的，并且点处给定的外部集中载荷为0，那么需要在该点处满足$M_{12}=0$：![image-20230221083526671](/Users/liuzhen/Library/Application Support/typora-user-images/image-20230221083526671.png)

  - 如果是非直角的话：

    - 首先注意这是在离散情况下，$M$在两条边上趋近该点的值是相等的；
    - 如果要满足$M_{nt}$的跳跃为0，在给定两个边上的法向法向值的时候，需要利用下述推导的关系式限制在该点处的$M_{n_{1}n_{2}}$的值；
    - 在计算的时候，转角和跳跃的条件是作为强制边值加上去的，从而对应的N应该满足法向法向的值为0，由跳跃处的关系式，对应的$N_{n_{1}n_{2}}$的值也是0；

    ![image-20230221083713587](/Users/liuzhen/Library/Application Support/typora-user-images/image-20230221083713587.png)

- 关于$[M_{nt}](\delta)$处的理解：

  - 假设连续层面的话，应该放在强制条件进行满足，因为$M\in H(divdiv)$空间的，其在某个点的值是没有意义的；和区域也有关系，当区域的边界比较光滑的时候，函数的性质就会更好，此时解在这个点的值或许是可以定义的，因此如果要在空间里加上这个条件，是对空间的一个强的要求；
  - 假设离散层面的话，可以提出更高光滑性的元，那么这个点的值是可以满足连续性的；

- 关于HHJ元基函数的实现方法：

  - 假设三角形的三条边分别记为$(e_{1},e_{2},e_{3})$，现在要计算在$e_{1}$边HHJ的基函数，也就是在这个边的法向法向取值为1，在其他两条边的法向法向分量取值为0的二阶张量。
  - 可以验证 $\frac{t_{2}t^{T}_{3}+t_{3}t_{2}^{T}}{2*(n_{1}^{T}t_{2}\cdot t
    _{3}^{T}n_{1})}$是满足上述要求的；



#### 230302  刘震 HHJ各种边值变分的提法

- 本次探讨的文章是： A DECOMPOSITION RESULT FOR KIRCHHOFF PLATE BENDING PROBLEMS AND A NEW DISCRETIZATION APPROACH

- 关于$Ndof$和$h$的关系，假设考虑的是正方形区域，沿着x方向的节点数是$N=1/h$,从而总的自由度个数等于某个常数倍的节点数$Ndof=N*N=1/h^2$，也就是$h = Ndof^{-1/2}$

- 关于矩形薄板四个边施加简支边界条件的级数解法（双级数解法）：

  - 由于四个边都是简支边，因此可以给出基底是sinsin，最终解只是找对应的系数；
  - 假设考虑的是均布力，只需将均布力在对应的基底展开，带入方程系数相等即可得到真实的解；
  - 假设考虑的是集中力，可以看成是均布力和某个$\delta$函数的作用，再代入之前的公式即可；

- 关于变分形式等价性的探讨：

  - 纯固支板HHJ变分形式解的存在唯一性的证明思路：
    - 先证明纯固支板HHJ变分形式的解是存在唯一的；
    - 再证明经典位移法的变分解就是纯固支板HHJ变分形式的解；
    - 由于两个变分的解都是唯一的，并且一个变分的解满足另一个变分，从而两个变分等价；
  - 本文变分形式解的存在唯一性的证明思路：
    - 先证明经典位移法的变分解就是本文推导变分的解；
    - 由于经典变分的解是存在唯一的，再证明本文变分的解是存在唯一的；
    - 由于两个变分的解都是唯一的，并且一个变分的解满足另一个变分，从而两个变分等价；
  - 上述两者的区别是本文变分的适定性需要先通过证明经典位移法的变分解满足本文推导的变分！

- 关于强制边值和自然边值的讨论：

  - 本文的变分在对挠度和弯矩所在的空间都施加了强制边值：

    - 强制挠度： $w = 0  \quad on \quad \Gamma_{c} \cup \Gamma_{s}$
    - 强制弯矩： $Mnn=0 \quad on \quad \Gamma_{s}\cup \Gamma_{{f}} \quad [Mnt]|_{x}=0 \quad on V_{f}$（在空间的定义中强制满足）
    - 自由转角和自由剪力（包含在方程中实现）

  - 定理 Let $\boldsymbol{N} \in \boldsymbol{L}^2(\Omega)_{\mathrm{sym}} \cap \boldsymbol{C}^1(\bar{\Omega})$. Then $\boldsymbol{N} \in \boldsymbol{H}\left(\operatorname{div} \operatorname{Div}, \Omega ; Q^*\right)_{\mathrm{sym}}$ if andonly if
    $$
    \mathbf{N}_{n n}=0 \quad \text { on } \Gamma_s \cup \Gamma_f \quad \text { and } \quad [ \mathbf{N}_{n t} ]_x=0 \quad \text { for all } x \in \mathcal{V}_{\Gamma, f}
    $$

  - 上述定理给出了本文定义的弱空间下其实是包含强制边值条件的，但是需要具有某种光滑性的函数才能体现出来，对于有限元空间也有上述的等价性。在具体实现的时候，本文采用了分成三个子问题的方法求解，并且把强制边值作为某种限制条件加在某个方程上，因此施加起来比较麻烦。gu

- 下一步计划：

  - 按照本文适定性的证明思路，从两个板拼接的经典变分出发推导出我们定义的两个板混合变分问题，然后说明混合变分问题的适定性infsup满足（可以利用本文的证明思路）；
  - 计算部分采用马睿张敏的divdiv元计算，这里需要注意divdiv元在边界上的迹是什么？这样才能知道哪些条件是可以作为本质条件施加在空间上的？



#### 230323  马睿 divdiv空间函数的迹

- 引入divdiv空间迹算子的定义：$H(\operatorname{div} \operatorname{div}, T) \rightarrow H^2(T)^{\prime}$ for $T \in \mathcal{T}$ 由下式定义：
  $$
  \left\langle\operatorname{tr}_T^{\mathrm{dDiv}}(\Theta), z\right\rangle_{\partial T}:=(\operatorname{div} \operatorname{div} \Theta, z)_T-(\Theta, \varepsilon \nabla z)_T
  $$

  - 引入记号定义迹算子的值域空间（$\mathbf{H}^{-3 / 2,-1 / 2}(\partial T):=\operatorname{tr}_T^{\mathrm{dDiv}}(H(\operatorname{div} \operatorname{div}, T)), \quad T \in \mathcal{T}$并不一定有具体的含义，可以理解为抽象的记号）；
  - 当考虑divdiv空间交上div空间的时候，可以将迹算子写出来：$\langle\mathbf{n} \cdot \operatorname{div} \boldsymbol{\Theta}, z\rangle_{\partial T}-\langle\boldsymbol{\Theta} \mathbf{n}, \nabla z\rangle_{\partial T}$
    - 写出来的含义就是可定义：

- 关于标准Sobolev空间迹的两种定义方式是等价的：

  - 一种是利用光滑函数在边界上的值，定义光滑函数的极限作为迹的映射；
  - 另一种是利用嵌入定理研究迹所属的空间；

- 弱意义下的迹不能直接定义在每条边上，但是$H^{1/2}$这种迹是可以直接定义在每条边上的，因此对于分布意义下的迹，要在对偶的意义下定义，比如$divDiv$的迹要借用$H^{2}_{0}$函数空间中的函数定义；

- 连续空间和有限元离散空间的逼近性：

  - 连续空间的迹可能在边界上是没有定义的，比如$H(div)$;
  - 由于有限元函数空间中的函数一般是分片光滑的，在边界上要提相对光滑的要求；
  - 引入光滑性更强的，可以在边界上定义迹的函数子空间，比如$\tilde H(div)$;	
  - 其中$\tilde H(div)$是在$H(div)$中稠密的，因此有限元的解一定能收敛到$H(div)$空间的解；





#### 230330  瑞姝 关于连续问题变分空间和交界处条件的提法

- 界面问题？能否有参考意义？
  - 考虑两种不同方程在不同区域上的计算，两者在交界处应该满足什么样的条件？
- 离散问题的求解是没问题的，问题是连续问题下交界面处的连续性条件是在什么意义下成立的（弱的意义下）
  - 交界面处用混合元的时候，除了位移转角相等以外，还需要力是相等的；
  - 难点在于两个板不是在同一个平直空间，而是有夹角的空间，要定义一个定义在这个非光滑流形上的空间
  - 难点在于$H(divDiv)$空间和$H(div)$空间在交界面处的条件是耦合的，平面应力问题的力$\sigma \cdot n$是连续的，薄板弯曲是$\sigma $；
- 四阶问题解的存在唯一性证明的两种思路：
  - 一种是直接分析infsup条件，好处是可以为离散情况的infsup条件证明提供帮助；
  - 一种是利用等价性证明，好处是可以避免分析连续问题适定性的繁杂运算，只需证明两个问题等价；
- 待做事项：
  - 瑞姝：确定两个板拼接问题的连续问题的提法，具体是在什么样的连续空间，交界处的条件是在什么意义下成立的，然后定义对应空间的范数，证明对应的适定性条件；
  - 刘震：证明连续问题的解的适定性，只需要说明经典变分意义下的解，也能推出来混合变分问题的解；现在的工作是看一下divDiv迹的文章后边的内容；



#### 230616  刘震 1989年文章的一些答疑

- 文章给出的理论部分并未考虑在交界面上施加外力的情况，考虑边界$\Gamma$上施加外力的情况，可考虑施加在任意一个面上，应该在变分$l$上加上$\int_{\Gamma} \boldsymbol{T} \cdot \boldsymbol{u_{h}} ds$；
- $\boldsymbol{u} = \underset{\sim}{\boldsymbol{u}}$  意思是在全局坐标系下两个向量完全相同！对应到局部坐标系的分量表示，则应该将坐标变换考虑进来，得到关于分量相等的式子；
- 板中面的内部力矩始终是平衡的，这是由弯矩的对称性保证的，中面内部的合力矩转换成边界上的力矩和内部的外力；线弹性连接和刚体连接的区别是，线弹性连接的时候，外力的效果由内部的弹簧变形所抵消，但是对于刚体的时候，施加在边界gamma上的外力实际上被施加在边界上的外力所抵消了，对于整个物体是刚体的话，力可以转移到其他地方进行计算，效果是一样的。但是对于弹性体，力施加的位置会影响变形，还是需要考虑的。
- 超收敛就是指收敛阶的精度相较一般意义下的收敛阶更高
  - 如果是比较的对象相同，但是范数不同，得到的阶不一样。通常情况下不能给出任意范数的误差估计，并且对于有限次多项式，利用负范数能提升的收敛阶是有限的。由于关心的问题不同，有时候关心最大值的误差$L^{\infin}$，有时候关心整体的平均误差$L^{2}$，有时候关心梯度的误差$H^{1}$，因此此种超收敛有意义；
  - 如果是比较的对象相同，范数也相同，得到的阶不一样。此时往往是利用了后处理将精度进行了提高，提高前的阶比较低，提高后的阶比较高。此种超收敛往往依赖于插值投影解和数值解的超收敛；
- 网格依赖范数的意义：
  - 给出收敛性的估计。证明infsup条件的时候，如果是在不依赖网格的范数下证明，可能很难。但是如果在网格依赖范数下，就可以给出其证明，从而说明问题的适定性。
  - 给出超收敛的结果。即使在一般情况下是可以证明infsup条件的，但是由于误差估计是借助infsup条件给出的，因此在网格依赖范数下的infsup条件可以给出网格依赖范数下的误差估计，有可能阶是更高的。





#### 待解决的一些问题

- 关于粱单元的能量表达式和变分形式的提法？其中挠曲线和转角的函数关系是相关的，因此只提出一个未知函数表达式，这和离散情形中 ，为了得到高精度的近似所引入转角自由度没关系，要注意区分！
- 关于鞍点问题的变分形式的确定，之前计算力学课程讲解中给定Lagrange乘子之后通过变分形式消去乘子，最后将乘子表示成$u,\varepsilon$的关系，但是现在HHJ文章中，给定乘子满足的方程之后，消去原来的变量得到新的变分形式，出发点是Lagrange乘子所在的空间是使得鞍点问题适定的空间，这样不同做法的道理是什么？
- 迹的意义是什么？在构造协调元的时候需要让迹是连续的，HHJ元构造非协调元的时候，要求边界上的$\tau_{nn}$是连续的，还有就是为什么可以作为对偶空间去定义迹，这样的话怎么计算呢？迹的强弱是什么意思？给定相同的Green公式，但是由于作用的空间不同，也可以定义不同的迹？
- 定义范数的时候，非协调元往往依赖网格，但是协调元范数不依赖网格，是否依赖网格对于收敛阶的影响是什么？对于稳定性的分析影响是什么？
